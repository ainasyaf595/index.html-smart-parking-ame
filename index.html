<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart Parking Online AME</title>
<style>
body {
  font-family: Poppins, Arial, sans-serif;
  background: #e5e5e5;
  margin:0; padding:20px; text-align:center;
}
h1 { font-size:2rem; margin-bottom:20px; color:#1f1f1f; }

/* PARKING AREA */
.parking-area {
  width:95%; max-width:900px;
  height:600px;
  margin:auto;
  background:#1f1f1f;
  border:4px solid #000;
  border-radius:12px;
  position:relative;
}

/* SLOT */
.slot {
  width:18%; height:25%;
  border:3px solid #fff; border-radius:6px;
  position:absolute; overflow:hidden;
  transition: background 0.5s;
}
.slot-label {
  position:absolute; top:5px; width:100%;
  text-align:center; color:#fff; font-size:0.9rem; font-weight:bold;
}
.pillar {
  position:absolute; bottom:5px; right:5px;
  background:#fff; color:#000;
  border:2px solid #000; padding:3px 6px;
  border-radius:6px; font-size:0.8rem; font-weight:bold;
}

/* CAR ICON */
.car-icon {
  width:40%; height:60%;
  background:#fff; border-radius:6px;
  position:absolute; left:30%; top:100%;
  opacity:0; transition:all 1s ease-in-out;
}

/* SLOT WARNA */
.slot.occupied { background:#ff4d4d; }
.slot.empty { background:#4CAF50; }

/* ANIMASI MASUK SLOT */
.slot.occupied .car-icon { opacity:1; top:20%; }
.slot.empty .car-icon { opacity:0; top:100%; }

/* JALAN */
.road-vertical {
  position:absolute; bottom:0; left:50%;
  transform:translateX(-50%);
  width:15%; height:100%;
  background:#2c2c2c;
  border-left:4px dashed #fff;
  border-right:4px dashed #fff;
  z-index:1;
}
.road-horizontal {
  position:absolute; top:50%; left:0;
  width:100%; height:15%;
  background:#2c2c2c;
  border-top:4px dashed #fff;
  border-bottom:4px dashed #fff;
  z-index:1;
}

/* ANAK PANAH */
.arrow {
  position:absolute;
  width:0; height:0;
  border-left:15px solid transparent;
  border-right:15px solid transparent;
  border-bottom:25px solid #fff;
  z-index:2;
}
.arrow-down { bottom:5%; left:50%; transform:translateX(-50%) rotate(0deg); }

/* STATUS */
.status-box {
  position:fixed; right:20px; bottom:20px;
  padding:15px 25px; font-size:1.2rem;
  background:#1f1f1f; color:white;
  border:3px solid #000; border-radius:12px;
  font-weight:bold; box-shadow:0 4px 12px rgba(0,0,0,0.4);
}
</style>
</head>
<body>

<h1>SMART PARKING ONLINE AME</h1>

<div class="parking-area">
  <!-- SLOT di sisi jalan menegak -->
  <div id="slot1" class="slot" style="left:10%; top:10%;"></div>
  <div id="slot2" class="slot" style="left:10%; top:40%;"></div>
  <div id="slot3" class="slot" style="left:70%; top:10%;"></div>
  <div id="slot4" class="slot" style="left:70%; top:40%;"></div>
  <div id="slot5" class="slot" style="left:40%; top:70%;"></div>

  <!-- JALAN -->
  <div class="road-vertical"></div>
  <div class="road-horizontal"></div>

  <!-- ANAK PANAH -->
  <div class="arrow arrow-down"></div>
</div>

<div class="status-box">
  Petak Kosong: <span id="count">0</span> / 5
</div>

<script>
// Inisialisasi slot
['slot1','slot2','slot3','slot4','slot5'].forEach(id=>{
  const div=document.getElementById(id);
  const label=document.createElement('div');
  label.className='slot-label'; label.innerText=id.toUpperCase();
  div.appendChild(label);
  const pillar=document.createElement('span');
  pillar.className='pillar'; pillar.innerText=id.replace('slot','');
  div.appendChild(pillar);
  const car=document.createElement('div');
  car.className='car-icon'; div.appendChild(car);
});

// Fetch data
async function loadData(){
  try{
    const url="https://smart-parking-aee-default-rtdb.asia-southeast1.firebasedatabase.app/parking.json";
    const res=await fetch(url);
    const data=await res.json();

    Object.keys(data).forEach(id=>{
      const div=document.getElementById(id);
      if(!div) return;
      if(data[id].status==='occupied'){ div.classList.add('occupied'); div.classList.remove('empty'); }
      else{ div.classList.remove('occupied'); div.classList.add('empty'); }
    });

    const count=Object.values(data).filter(slot=>slot.status==='empty').length;
    document.getElementById('count').innerText=count;

  }catch(err){ console.error(err); }
}
setInterval(loadData,1000); loadData();
</script>

</body>
</html>
